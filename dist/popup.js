!function(){"use strict";var t;!function(t){t.INITIAL="INITIAL",t.VIDEO_CHOSEN="VIDEO_CHOSEN"}(t||(t={}));const e=new class{constructor(){if(this.state=t.INITIAL,this.chooseVideoSourceBtn=document.getElementById("chooseVideoSourceButton"),this.startTrackingBtn=document.getElementById("startTrackingButton"),this.stopTrackingBtn=document.getElementById("stopTrackingButton"),!this.chooseVideoSourceBtn||!this.startTrackingBtn||!this.stopTrackingBtn)throw new Error("One or more buttons are missing in the DOM.")}getChooseVideoSourceButton(){return this.chooseVideoSourceBtn}getStartTrackingButton(){return this.startTrackingBtn}getStopTrackingButton(){return this.stopTrackingBtn}getState(){return this.state}setState(t){this.state=t,console.log(`Popup state changed to: ${this.state}`),this.updateUIOnStateChange(),chrome.storage.local.set({popupState:this.state},(()=>{console.log("Popup state saved to storage: ",this.state)}))}updateUIOnStateChange(){this.state===t.INITIAL?(this.chooseVideoSourceBtn.disabled=!1,this.startTrackingBtn.disabled=!0,this.stopTrackingBtn.disabled=!0):this.state===t.VIDEO_CHOSEN&&(this.chooseVideoSourceBtn.disabled=!0,this.startTrackingBtn.disabled=!1,this.stopTrackingBtn.disabled=!0)}};console.log("Popup loaded"),document.addEventListener("DOMContentLoaded",(function(){chrome.storage.local.get("popupState",(o=>{const n=o.popupState;n?(console.log("Restoring saved state from storage: ",n),e.setState(n)):(console.log("No saved state found in storage, using initial state."),e.setState(t.INITIAL))})),chrome.runtime.onMessage.addListener(((o,n,s)=>{console.log("Message received in popup:",o),console.log("From sender:",n),"VIDEO_SOURCE_CHOSEN"===o.type&&(console.log("Video source chosen in popup"),e.setState(t.VIDEO_CHOSEN))})),console.log("Choose video source button:",e.getChooseVideoSourceButton()),console.log("Start button:",e.getStartTrackingButton()),console.log("Stop button:",e.getStopTrackingButton()),e.getChooseVideoSourceButton()&&e.getChooseVideoSourceButton().addEventListener("click",(()=>{console.log("Choose video source button clicked"),chrome.runtime.sendMessage({type:"CHOOSE_VIDEO_SOURCE"})})),e.getStartTrackingButton()&&e.getStartTrackingButton().addEventListener("click",(()=>{console.log("Start button clicked"),chrome.runtime.sendMessage({type:"START_TRACKING"})})),e.getStopTrackingButton()&&e.getStopTrackingButton().addEventListener("click",(()=>{console.log("Stop button clicked"),chrome.runtime.sendMessage({type:"STOP_TRACKING"})}))}))}();